import{a as Ht,d as Xn,e as Lt,_ as Gt,f as Yn,g as wn,h as Un}from"./index-BNn2tC2b.js";/* empty css                  *//* empty css                  *//* empty css                 */import{aA as jt,h as Fe,c as ze,y as qt,r as Y,l as Hn,I as we,A as R,J as b,R as c,B as m,O as G,W as zt,P as X,n as Ze,U as Tn,z as te,L as le,Q as wt,a6 as Tt,u as Q,E as En,j as Gn,K as ln}from"./vendor-OArhA24O.js";import{j as z,i as gt,A as Sn,x as jn,y as kn,B as qn,C as Kn,D as Qn,F as Zn,g as Kt,w as Jn,n as Cn,p as ea,G as ta,H as na,b as Dn,I as aa,J as oa,K as ra,L as la,q as ia,M as sa,N as ua,O as ca,P as Pt,Q as It,R as da,S as fa,T as sn,U as un,V as cn,W as dn}from"./element-Ci-NFJgn.js";function pa(){const n=Ht(),{tasks:e,loading:t,error:a,taskStats:o,selectedTasks:r}=jt(n),{onTaskUpdate:l,setFastPolling:i}=Xn(),s=async w=>{i(!0);try{await n.executeTask(w),z.success("任务已开始执行")}catch(P){z.error(`执行任务失败: ${P}`)}finally{setTimeout(()=>{i(!1)},3e4)}},u=async w=>{if(w.length===0){z.warning("请先选择要执行的任务");return}try{await gt.confirm(`确定要批量执行 ${w.length} 个任务吗？`,"确认批量执行",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),i(!0),await n.executeBatchTasks(w),z.success(`已开始批量执行 ${w.length} 个任务`),n.clearSelection()}catch(P){P!=="cancel"&&z.error(`批量执行失败: ${P}`)}finally{setTimeout(()=>{i(!1)},6e4)}},y=async w=>{try{await gt.confirm("确定要删除这个任务吗？","确认删除",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}),await n.deleteTask(w),z.success("任务已删除")}catch(P){P!=="cancel"&&z.error(`删除任务失败: ${P}`)}},g=async w=>{if(w.length===0){z.warning("请先选择要删除的任务");return}try{await gt.confirm(`确定要删除 ${w.length} 个任务吗？此操作不可恢复。`,"确认批量删除",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}),await n.deleteBatchTasks(w),z.success(`已删除 ${w.length} 个任务`),n.clearSelection()}catch(P){P!=="cancel"&&z.error(`批量删除失败: ${P}`)}},S=async(w,P)=>{try{const I=await n.shareTask(w,P);return I!=null&&I.url&&(await navigator.clipboard.writeText(I.url),z.success("分享链接已复制到剪贴板")),I}catch(I){throw z.error(`生成分享链接失败: ${I}`),I}},k=(w,P,I)=>ze(()=>{let F=e.value;if(w){const N=w.toLowerCase();F=F.filter(U=>{var ne;return((ne=U.name)==null?void 0:ne.toLowerCase().includes(N))||U.url.toLowerCase().includes(N)||U.save_dir.toLowerCase().includes(N)})}return P!=="all"&&(F=F.filter(N=>N.status===P)),I&&I!=="all"&&(F=F.filter(N=>N.category===I)),F}),C=(w,P,I="asc")=>ze(()=>[...w].sort((F,N)=>{let U=F[P],ne=N[P];return typeof U=="string"&&typeof ne=="string"&&(U=U.toLowerCase(),ne=ne.toLowerCase()),U<ne?I==="asc"?-1:1:U>ne?I==="asc"?1:-1:0})),f=async(w,P)=>{try{await n.moveTask(w,P),z.success("任务顺序已更新")}catch(I){z.error(`更新任务顺序失败: ${I}`)}},W=async()=>{await n.fetchTasks(),l(w=>{n.handleTaskUpdate(w)})};Fe(a,w=>{w&&(z.error(w),n.clearError())});const j=w=>{const P=new Map;Fe(e,I=>{I.forEach(F=>{const N=P.get(F.order);N&&N.status!==F.status&&w(F,N.status,F.status),P.set(F.order,{...F})})},{deep:!0})};return{tasks:e,loading:t,error:a,taskStats:o,selectedTasks:r,initTasks:W,addTask:n.addTask,updateTask:n.updateTask,executeTask:s,executeBatchTasks:u,deleteTask:y,deleteBatchTasks:g,shareTask:S,moveTask:f,selectTask:n.selectTask,unselectTask:n.unselectTask,selectAllTasks:n.selectAllTasks,clearSelection:n.clearSelection,toggleTaskSelection:n.toggleTaskSelection,filterTasks:k,sortTasks:C,onTaskStatusChange:j,fetchTasks:n.fetchTasks}}const ha={class:"path-input-group"},ga={class:"cron-input-group"},ma={class:"dialog-footer"},va=qt({__name:"AddTaskDialog",props:{modelValue:{type:Boolean},task:{default:null}},emits:["update:modelValue","success"],setup(n,{emit:e}){const t=n,a=e,o=Ht(),{taskSavePaths:r,taskCategories:l,taskCronRules:i,taskRegexPatterns:s,taskRegexReplaces:u,getDefaultSavePath:y}=jt(o),g=Y(),S=Y(!1),k=Y(!0),C=Y(!1),f=Hn({name:"",url:"",save_dir:"",category:"",cron:"",regex_pattern:"",regex_replace:""}),W=Y([]),j={url:[{required:!0,message:"请输入分享链接",trigger:"blur"},{pattern:/^https:\/\/pan\.baidu\.com\/s\/[a-zA-Z0-9_-]+/,message:"请输入有效的百度网盘分享链接",trigger:"blur"}],save_dir:[{required:!0,message:"请输入保存路径",trigger:"blur"}]},w=ze({get:()=>t.modelValue,set:h=>a("update:modelValue",h)}),P=ze(()=>t.task),I=()=>{var h;f.name="",f.url="",f.save_dir=y.value||"",f.category="",f.cron="",f.regex_pattern="",f.regex_replace="",W.value=[],k.value=!0,(h=g.value)==null||h.resetFields()},F=async()=>{if(!(!f.url||C.value))try{C.value=!0;let h=f.url.split("#")[0],v="";h.includes("?pwd=")?[h,v]=h.split("?pwd="):h.includes("&pwd=")&&([h,v]=h.split("&pwd="));const $=await Lt.getShareInfo(h,v);if($.success&&$.folder_name){const L=$.folder_name;if(f.name||(f.name=L),k.value&&L){const J=(y.value||"").replace(/\/+$/,"");f.save_dir=J?`${J}/${L}`:`/${L}`}}}catch(h){console.warn("URL解析失败:",h)}finally{C.value=!1}},N=()=>{if(!k.value||!f.name)return;const v=(y.value||"").replace(/\/+$/,"");f.save_dir=v?`${v}/${f.name}`:`/${f.name}`},U=(h,v)=>{const $=r.value.filter(L=>L.toLowerCase().includes(h.toLowerCase())).map(L=>({value:L}));v($)},ne=(h,v)=>{const $=l.value.filter(L=>L.toLowerCase().includes(h.toLowerCase())).map(L=>({value:L}));v($)},q=(h,v)=>{const $=["*/5 * * * *","0 * * * *","0 0 * * *","0 0 * * 0","0 0 1 * *"],ae=[...new Set([...$,...i.value])].filter(J=>J.toLowerCase().includes(h.toLowerCase())).map(J=>({value:J}));v(ae)},pe=(h,v)=>{const $=["^(\\d+)\\.mp4$","^.*\\.(mp4|mkv|avi)$","^.*\\.(jpg|png|gif)$","^.*\\.pdf$"],ae=[...new Set([...$,...s.value])].filter(J=>J.toLowerCase().includes(h.toLowerCase())).map(J=>({value:J}));v(ae)},he=(h,v)=>{const $=["第$1集.mp4","S01E$1.mp4","$1话.mp4"],ae=[...new Set([...$,...u.value])].filter(J=>J.toLowerCase().includes(h.toLowerCase())).map(J=>({value:J}));v(ae)},ye=h=>{f.name=h.name||"";let v=h.url;if(h.pwd&&h.pwd.trim()!==""&&!h.url.includes("?pwd=")&&!h.url.includes("&pwd=")){const $=h.url.includes("?")?"&":"?";v=`${h.url}${$}pwd=${h.pwd}`}f.url=v,f.save_dir=h.save_dir,f.category=h.category||"",f.cron=h.cron||"",f.regex_pattern=h.regex_pattern||"",f.regex_replace=h.regex_replace||"",k.value=!1,(h.cron||h.regex_pattern||h.regex_replace)&&(W.value=["advanced"])},ie=()=>{z({type:"info",duration:5e3,dangerouslyUseHTMLString:!0,message:`
      <div style="text-align: left;">
        <strong>常用Cron表达式：</strong><br/>
        • */5 * * * * - 每5分钟<br/>
        • 0 */1 * * * - 每小时<br/>
        • 0 0 * * * - 每天0点<br/>
        • 0 0 */3 * * - 每3天0点<br/>
        • 0 0 * * 0 - 每周日0点
      </div>
    `})},ce=async()=>{if(!(!g.value||!await g.value.validate().catch(()=>!1))){S.value=!0;try{P.value?(await o.updateTask(P.value.order-1,f),z.success("任务已更新")):(await o.addTask(f),z.success("任务已添加")),w.value=!1,I(),a("success")}catch(v){z.error(`操作失败: ${v}`)}finally{S.value=!1}}},M=()=>{w.value=!1,I()};Fe(()=>t.task,(h,v)=>{Ze(()=>{h?ye(h):I()})},{immediate:!0});const E=()=>{window.innerWidth<=1200&&Ze(()=>{const h=document.querySelector(".add-task-dialog .el-dialog__footer");if(h){const $=h;$.style.setProperty("position","fixed","important"),$.style.setProperty("bottom","0","important"),$.style.setProperty("left","0","important"),$.style.setProperty("right","0","important"),$.style.setProperty("z-index","10001","important"),$.style.setProperty("background","white","important"),$.style.setProperty("box-shadow","0 -2px 8px rgba(0, 0, 0, 0.1)","important");const L=getComputedStyle(document.documentElement).getPropertyValue("env(safe-area-inset-bottom)")||"20px";$.style.setProperty("padding-bottom",`calc(16px + ${L})`,"important")}const v=document.querySelector(".add-task-dialog .el-dialog__body");if(v){const $=v;$.style.setProperty("padding-bottom","120px","important"),$.style.setProperty("height","calc(100vh - 160px)","important")}})};return Fe(w,h=>{h?(t.task||Ze(()=>{I()}),E()):I()}),Fe(()=>f.name,h=>{k.value&&h&&N()}),Fe(k,h=>{h&&f.name&&N()}),(h,v)=>{const $=kn,L=jn,ae=qn,J=Kn,Ce=Kt,Ge=Zn,de=Qn,Ie=Jn,We=Sn;return R(),we(We,{modelValue:w.value,"onUpdate:modelValue":v[10]||(v[10]=K=>w.value=K),title:P.value?"编辑任务":"添加任务",width:"650px","close-on-click-modal":!1,class:"add-task-dialog","lock-scroll":!1},{footer:b(()=>[m("div",ma,[c(Ce,{onClick:M},{default:b(()=>[...v[16]||(v[16]=[G("取消",-1)])]),_:1}),c(Ce,{type:"primary",loading:S.value,onClick:ce},{default:b(()=>[G(X(P.value?"更新":"添加"),1)]),_:1},8,["loading"])])]),default:b(()=>[c(Ie,{ref_key:"formRef",ref:g,model:f,rules:j,"label-width":"80px",onSubmit:zt(ce,["prevent"])},{default:b(()=>[c(L,{label:"任务名称",prop:"name"},{default:b(()=>[c($,{modelValue:f.name,"onUpdate:modelValue":v[0]||(v[0]=K=>f.name=K),placeholder:"可选，用于标识任务",clearable:"",onInput:v[1]||(v[1]=K=>k.value&&N())},null,8,["modelValue"])]),_:1}),c(L,{label:"转存链接",prop:"url"},{default:b(()=>[c($,{modelValue:f.url,"onUpdate:modelValue":v[2]||(v[2]=K=>f.url=K),placeholder:"https://pan.baidu.com/s/xxx 或 https://pan.baidu.com/s/xxx?pwd=1234",clearable:"",onBlur:F,loading:C.value},null,8,["modelValue","loading"]),v[11]||(v[11]=m("div",{class:"form-help"},"支持带密码的转存链接，格式：链接?pwd=密码",-1))]),_:1}),c(L,{label:"保存路径",prop:"save_dir"},{default:b(()=>[m("div",ha,[c(ae,{modelValue:f.save_dir,"onUpdate:modelValue":v[3]||(v[3]=K=>f.save_dir=K),"fetch-suggestions":U,placeholder:"例如：/我的资源/电影",clearable:"","value-key":"value",class:"path-select"},null,8,["modelValue"]),c(J,{modelValue:k.value,"onUpdate:modelValue":v[4]||(v[4]=K=>k.value=K),class:"sync-switch",size:"small",title:k.value?"已关联任务名称":"未关联任务名称",onChange:N},null,8,["modelValue","title"])])]),_:1}),c(L,{label:"分类",prop:"category"},{default:b(()=>[c(ae,{modelValue:f.category,"onUpdate:modelValue":v[5]||(v[5]=K=>f.category=K),"fetch-suggestions":ne,placeholder:"可选，用于任务分类",clearable:"","value-key":"value",style:{width:"100%"}},null,8,["modelValue"])]),_:1}),c(de,{modelValue:W.value,"onUpdate:modelValue":v[9]||(v[9]=K=>W.value=K),class:"advanced-settings"},{default:b(()=>[c(Ge,{title:"高级设置",name:"advanced"},{default:b(()=>[c(L,{label:"定时规则",prop:"cron"},{default:b(()=>[m("div",ga,[c(ae,{modelValue:f.cron,"onUpdate:modelValue":v[6]||(v[6]=K=>f.cron=K),"fetch-suggestions":q,placeholder:"可选，使用cron表达式，例如: */5 * * * *",clearable:"","value-key":"value",class:"cron-select"},null,8,["modelValue"]),c(Ce,{onClick:ie,size:"small"},{default:b(()=>[...v[12]||(v[12]=[G("cron助手",-1)])]),_:1})]),v[13]||(v[13]=m("div",{class:"form-help"},"留空则使用默认定时规则，例如：*/5 * * * * 表示每5分钟执行一次",-1))]),_:1}),c(L,{label:"文件过滤",prop:"regex_pattern"},{default:b(()=>[c(ae,{modelValue:f.regex_pattern,"onUpdate:modelValue":v[7]||(v[7]=K=>f.regex_pattern=K),"fetch-suggestions":pe,placeholder:"如：^(\\d+)\\.mp4$ 用于匹配需要转存的文件",clearable:"","value-key":"value",style:{width:"100%"}},null,8,["modelValue"]),v[14]||(v[14]=m("div",{class:"form-help"},"正则表达式，用于匹配需要转存的文件，留空表示不过滤",-1))]),_:1}),c(L,{label:"文件重命名",prop:"regex_replace"},{default:b(()=>[c(ae,{modelValue:f.regex_replace,"onUpdate:modelValue":v[8]||(v[8]=K=>f.regex_replace=K),"fetch-suggestions":he,placeholder:"如：第\\1集.mp4 用于重命名文件",clearable:"","value-key":"value",style:{width:"100%"}},null,8,["modelValue"]),v[15]||(v[15]=m("div",{class:"form-help"},"正则表达式替换，用于重命名文件，留空表示不重命名",-1))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}}),_a=Gt(va,[["__scopeId","data-v-3b32a7c6"]]),ba={class:"task-runner-content"},ya={class:"task-info-section"},wa={class:"task-info-grid"},Ta={class:"info-item"},Ea={class:"value"},Sa={class:"info-item"},ka={class:"value"},Ca={class:"info-item"},Da={class:"info-item"},xa={class:"value"},Pa={class:"status-section"},Ia={class:"status-progress"},Oa={class:"progress-info"},$a={class:"current-message"},Aa={class:"elapsed-time"},Na={key:0,class:"progress-bar"},Ma={key:1,class:"result-info"},Va={key:0,class:"files-section"},Ra={class:"section-title"},Ba={class:"files-list"},Fa={class:"file-name"},La={key:0,class:"file-size"},za={class:"logs-section"},Wa={class:"section-title"},Xa={key:0,class:"no-logs"},Ya={class:"log-time"},Ua={class:"log-level"},Ha={class:"log-message"},Ga={class:"dialog-footer"},ja=qt({__name:"TaskRunnerDialog",props:{modelValue:{type:Boolean},task:{},taskId:{}},emits:["update:modelValue","task-completed","task-cancelled"],setup(n,{emit:e}){var ie,ce;const t=n,a=e,o=ze({get:()=>t.modelValue,set:M=>a("update:modelValue",M)}),r=Y(((ie=t.task)==null?void 0:ie.status)||"normal"),l=Y(((ce=t.task)==null?void 0:ce.message)||""),i=Y(""),s=Y("00:00"),u=Y([]),y=Y([]),g=Y(!1),S=Y(),k=Y(!1);let C=null,f=null,W=null;const j=ze(()=>r.value==="running"),w=M=>({normal:"info",running:"warning",success:"success",error:"danger"})[M]||"info",P=M=>wn(M),I=M=>({success:"success",error:"error",running:"warning",normal:"info"})[M]||"info",F=M=>{if(!M)return"";try{return new Date(M).toLocaleTimeString()}catch{return M}},N=()=>{if(!W)return;const E=new Date().getTime()-W.getTime(),h=Math.floor(E/6e4),v=Math.floor(E%6e4/1e3);s.value=`${h.toString().padStart(2,"0")}:${v.toString().padStart(2,"0")}`},U=()=>{t.task&&(W=new Date,i.value=W.toLocaleString(),r.value="running",l.value="任务正在执行中...",f=setInterval(N,1e3),C=setInterval(async()=>{await ne()},2e3),ne())},ne=async()=>{var M;if(t.task)try{const E=await Lt.getTaskStatus(t.taskId);if(E.success){const h=E.status||E.data,v=r.value;r.value=h.status,l.value=h.message||"",h.transferred_files&&(u.value=h.transferred_files),v==="running"&&h.status!=="running"&&(pe(),a("task-completed",h),h.status==="success"||h.status==="normal"&&((M=h.message)!=null&&M.includes("成功"))?z.success("任务执行完成"):h.status==="error"&&z.error("任务执行失败"))}}catch(E){console.error("检查任务状态失败:",E)}},q=async()=>{var M;g.value=!0;try{const E=await Lt.getLogs(50);E.success&&(y.value=(E.logs||((M=E.data)==null?void 0:M.logs)||[]).slice(-20),await Ze(),S.value&&(S.value.scrollTop=S.value.scrollHeight))}catch(E){console.error("获取日志失败:",E)}finally{g.value=!1}},pe=()=>{C&&(clearInterval(C),C=null),f&&(clearInterval(f),f=null)},he=async()=>{k.value=!0;try{z.warning("任务取消功能暂未实现"),a("task-cancelled")}catch{z.error("取消任务失败")}finally{k.value=!1}},ye=()=>{pe(),o.value=!1};return Fe(()=>t.modelValue,M=>{M&&t.task?(U(),q()):pe()}),Tn(()=>{pe()}),(M,E)=>{const h=Cn,v=ea,$=ta,L=Dn,ae=Kt,J=Sn;return R(),we(J,{modelValue:o.value,"onUpdate:modelValue":E[0]||(E[0]=Ce=>o.value=Ce),title:"任务执行监控",width:"800px","before-close":ye,"close-on-click-modal":!1,"close-on-press-escape":!1,class:"task-runner-dialog"},{footer:b(()=>[m("div",Ga,[j.value?(R(),we(ae,{key:0,type:"warning",onClick:he,loading:k.value},{default:b(()=>[...E[9]||(E[9]=[G(" 取消执行 ",-1)])]),_:1},8,["loading"])):le("",!0),c(ae,{onClick:ye},{default:b(()=>[G(X(j.value?"最小化":"关闭"),1)]),_:1})])]),default:b(()=>{var Ce,Ge;return[m("div",ba,[m("div",ya,[E[5]||(E[5]=m("h3",{class:"section-title"},"任务信息",-1)),m("div",wa,[m("div",Ta,[E[1]||(E[1]=m("span",{class:"label"},"任务名称:",-1)),m("span",Ea,X(((Ce=M.task)==null?void 0:Ce.name)||"未命名任务"),1)]),m("div",Sa,[E[2]||(E[2]=m("span",{class:"label"},"保存路径:",-1)),m("span",ka,X((Ge=M.task)==null?void 0:Ge.save_dir),1)]),m("div",Ca,[E[3]||(E[3]=m("span",{class:"label"},"执行状态:",-1)),c(h,{type:w(r.value),size:"default"},{default:b(()=>[G(X(P(r.value)),1)]),_:1},8,["type"])]),m("div",Da,[E[4]||(E[4]=m("span",{class:"label"},"开始时间:",-1)),m("span",xa,X(i.value),1)])])]),m("div",Pa,[E[6]||(E[6]=m("h3",{class:"section-title"},"执行状态",-1)),m("div",Ia,[m("div",Oa,[m("div",$a,X(l.value||"等待执行..."),1),m("div",Aa," 执行时间: "+X(s.value),1)]),j.value?(R(),te("div",Na,[c(v,{percentage:100,indeterminate:!0,duration:3,status:"success"})])):le("",!0),!j.value&&l.value?(R(),te("div",Ma,[c($,{type:I(r.value),title:l.value,"show-icon":"",closable:!1},null,8,["type","title"])])):le("",!0)])]),u.value&&u.value.length>0?(R(),te("div",Va,[m("h3",Ra,"转存文件 ("+X(u.value.length)+")",1),m("div",Ba,[(R(!0),te(wt,null,Tt(u.value,(de,Ie)=>(R(),te("div",{key:Ie,class:"file-item"},[c(L,{class:"file-icon"},{default:b(()=>[c(Q(na))]),_:1}),m("span",Fa,X(de.name||de.path||de),1),de.size?(R(),te("span",La,X(Q(Yn)(de.size)),1)):le("",!0)]))),128))])])):le("",!0),m("div",za,[m("h3",Wa,[E[8]||(E[8]=G(" 执行日志 ",-1)),c(ae,{size:"small",type:"primary",text:"",onClick:q,loading:g.value},{default:b(()=>[...E[7]||(E[7]=[G(" 刷新日志 ",-1)])]),_:1},8,["loading"])]),m("div",{class:"logs-container",ref_key:"logsContainer",ref:S},[y.value.length===0?(R(),te("div",Xa," 暂无日志信息 ")):le("",!0),(R(!0),te(wt,null,Tt(y.value,(de,Ie)=>(R(),te("div",{key:Ie,class:En(["log-entry",`log-${de.level.toLowerCase()}`])},[m("span",Ya,X(F(de.timestamp)),1),m("span",Ua,X(de.level),1),m("span",Ha,X(de.message),1)],2))),128))],512)])])]}),_:1},8,["modelValue"])}}}),qa=Gt(ja,[["__scopeId","data-v-a1786d7a"]]);/**!
 * Sortable 1.15.6
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function fn(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(n);e&&(a=a.filter(function(o){return Object.getOwnPropertyDescriptor(n,o).enumerable})),t.push.apply(t,a)}return t}function Pe(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?fn(Object(t),!0).forEach(function(a){Ka(n,a,t[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):fn(Object(t)).forEach(function(a){Object.defineProperty(n,a,Object.getOwnPropertyDescriptor(t,a))})}return n}function mt(n){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?mt=function(e){return typeof e}:mt=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mt(n)}function Ka(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function Ae(){return Ae=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(n[a]=t[a])}return n},Ae.apply(this,arguments)}function Qa(n,e){if(n==null)return{};var t={},a=Object.keys(n),o,r;for(r=0;r<a.length;r++)o=a[r],!(e.indexOf(o)>=0)&&(t[o]=n[o]);return t}function Za(n,e){if(n==null)return{};var t=Qa(n,e),a,o;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);for(o=0;o<r.length;o++)a=r[o],!(e.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(n,a)&&(t[a]=n[a])}return t}var Ja="1.15.6";function $e(n){if(typeof window<"u"&&window.navigator)return!!navigator.userAgent.match(n)}var Ne=$e(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),ut=$e(/Edge/i),pn=$e(/firefox/i),ot=$e(/safari/i)&&!$e(/chrome/i)&&!$e(/android/i),Qt=$e(/iP(ad|od|hone)/i),xn=$e(/chrome/i)&&$e(/android/i),Pn={capture:!1,passive:!1};function V(n,e,t){n.addEventListener(e,t,!Ne&&Pn)}function A(n,e,t){n.removeEventListener(e,t,!Ne&&Pn)}function Et(n,e){if(e){if(e[0]===">"&&(e=e.substring(1)),n)try{if(n.matches)return n.matches(e);if(n.msMatchesSelector)return n.msMatchesSelector(e);if(n.webkitMatchesSelector)return n.webkitMatchesSelector(e)}catch{return!1}return!1}}function In(n){return n.host&&n!==document&&n.host.nodeType?n.host:n.parentNode}function ke(n,e,t,a){if(n){t=t||document;do{if(e!=null&&(e[0]===">"?n.parentNode===t&&Et(n,e):Et(n,e))||a&&n===t)return n;if(n===t)break}while(n=In(n))}return null}var hn=/\s+/g;function _e(n,e,t){if(n&&e)if(n.classList)n.classList[t?"add":"remove"](e);else{var a=(" "+n.className+" ").replace(hn," ").replace(" "+e+" "," ");n.className=(a+(t?" "+e:"")).replace(hn," ")}}function D(n,e,t){var a=n&&n.style;if(a){if(t===void 0)return document.defaultView&&document.defaultView.getComputedStyle?t=document.defaultView.getComputedStyle(n,""):n.currentStyle&&(t=n.currentStyle),e===void 0?t:t[e];!(e in a)&&e.indexOf("webkit")===-1&&(e="-webkit-"+e),a[e]=t+(typeof t=="string"?"":"px")}}function Je(n,e){var t="";if(typeof n=="string")t=n;else do{var a=D(n,"transform");a&&a!=="none"&&(t=a+" "+t)}while(!e&&(n=n.parentNode));var o=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return o&&new o(t)}function On(n,e,t){if(n){var a=n.getElementsByTagName(e),o=0,r=a.length;if(t)for(;o<r;o++)t(a[o],o);return a}return[]}function xe(){var n=document.scrollingElement;return n||document.documentElement}function re(n,e,t,a,o){if(!(!n.getBoundingClientRect&&n!==window)){var r,l,i,s,u,y,g;if(n!==window&&n.parentNode&&n!==xe()?(r=n.getBoundingClientRect(),l=r.top,i=r.left,s=r.bottom,u=r.right,y=r.height,g=r.width):(l=0,i=0,s=window.innerHeight,u=window.innerWidth,y=window.innerHeight,g=window.innerWidth),(e||t)&&n!==window&&(o=o||n.parentNode,!Ne))do if(o&&o.getBoundingClientRect&&(D(o,"transform")!=="none"||t&&D(o,"position")!=="static")){var S=o.getBoundingClientRect();l-=S.top+parseInt(D(o,"border-top-width")),i-=S.left+parseInt(D(o,"border-left-width")),s=l+r.height,u=i+r.width;break}while(o=o.parentNode);if(a&&n!==window){var k=Je(o||n),C=k&&k.a,f=k&&k.d;k&&(l/=f,i/=C,g/=C,y/=f,s=l+y,u=i+g)}return{top:l,left:i,bottom:s,right:u,width:g,height:y}}}function gn(n,e,t){for(var a=Le(n,!0),o=re(n)[e];a;){var r=re(a)[t],l=void 0;if(l=o>=r,!l)return a;if(a===xe())break;a=Le(a,!1)}return!1}function et(n,e,t,a){for(var o=0,r=0,l=n.children;r<l.length;){if(l[r].style.display!=="none"&&l[r]!==x.ghost&&(a||l[r]!==x.dragged)&&ke(l[r],t.draggable,n,!1)){if(o===e)return l[r];o++}r++}return null}function Zt(n,e){for(var t=n.lastElementChild;t&&(t===x.ghost||D(t,"display")==="none"||e&&!Et(t,e));)t=t.previousElementSibling;return t||null}function Te(n,e){var t=0;if(!n||!n.parentNode)return-1;for(;n=n.previousElementSibling;)n.nodeName.toUpperCase()!=="TEMPLATE"&&n!==x.clone&&(!e||Et(n,e))&&t++;return t}function mn(n){var e=0,t=0,a=xe();if(n)do{var o=Je(n),r=o.a,l=o.d;e+=n.scrollLeft*r,t+=n.scrollTop*l}while(n!==a&&(n=n.parentNode));return[e,t]}function eo(n,e){for(var t in n)if(n.hasOwnProperty(t)){for(var a in e)if(e.hasOwnProperty(a)&&e[a]===n[t][a])return Number(t)}return-1}function Le(n,e){if(!n||!n.getBoundingClientRect)return xe();var t=n,a=!1;do if(t.clientWidth<t.scrollWidth||t.clientHeight<t.scrollHeight){var o=D(t);if(t.clientWidth<t.scrollWidth&&(o.overflowX=="auto"||o.overflowX=="scroll")||t.clientHeight<t.scrollHeight&&(o.overflowY=="auto"||o.overflowY=="scroll")){if(!t.getBoundingClientRect||t===document.body)return xe();if(a||e)return t;a=!0}}while(t=t.parentNode);return xe()}function to(n,e){if(n&&e)for(var t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}function Ot(n,e){return Math.round(n.top)===Math.round(e.top)&&Math.round(n.left)===Math.round(e.left)&&Math.round(n.height)===Math.round(e.height)&&Math.round(n.width)===Math.round(e.width)}var rt;function $n(n,e){return function(){if(!rt){var t=arguments,a=this;t.length===1?n.call(a,t[0]):n.apply(a,t),rt=setTimeout(function(){rt=void 0},e)}}}function no(){clearTimeout(rt),rt=void 0}function An(n,e,t){n.scrollLeft+=e,n.scrollTop+=t}function Nn(n){var e=window.Polymer,t=window.jQuery||window.Zepto;return e&&e.dom?e.dom(n).cloneNode(!0):t?t(n).clone(!0)[0]:n.cloneNode(!0)}function Mn(n,e,t){var a={};return Array.from(n.children).forEach(function(o){var r,l,i,s;if(!(!ke(o,e.draggable,n,!1)||o.animated||o===t)){var u=re(o);a.left=Math.min((r=a.left)!==null&&r!==void 0?r:1/0,u.left),a.top=Math.min((l=a.top)!==null&&l!==void 0?l:1/0,u.top),a.right=Math.max((i=a.right)!==null&&i!==void 0?i:-1/0,u.right),a.bottom=Math.max((s=a.bottom)!==null&&s!==void 0?s:-1/0,u.bottom)}}),a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}var me="Sortable"+new Date().getTime();function ao(){var n=[],e;return{captureAnimationState:function(){if(n=[],!!this.options.animation){var a=[].slice.call(this.el.children);a.forEach(function(o){if(!(D(o,"display")==="none"||o===x.ghost)){n.push({target:o,rect:re(o)});var r=Pe({},n[n.length-1].rect);if(o.thisAnimationDuration){var l=Je(o,!0);l&&(r.top-=l.f,r.left-=l.e)}o.fromRect=r}})}},addAnimationState:function(a){n.push(a)},removeAnimationState:function(a){n.splice(eo(n,{target:a}),1)},animateAll:function(a){var o=this;if(!this.options.animation){clearTimeout(e),typeof a=="function"&&a();return}var r=!1,l=0;n.forEach(function(i){var s=0,u=i.target,y=u.fromRect,g=re(u),S=u.prevFromRect,k=u.prevToRect,C=i.rect,f=Je(u,!0);f&&(g.top-=f.f,g.left-=f.e),u.toRect=g,u.thisAnimationDuration&&Ot(S,g)&&!Ot(y,g)&&(C.top-g.top)/(C.left-g.left)===(y.top-g.top)/(y.left-g.left)&&(s=ro(C,S,k,o.options)),Ot(g,y)||(u.prevFromRect=y,u.prevToRect=g,s||(s=o.options.animation),o.animate(u,C,g,s)),s&&(r=!0,l=Math.max(l,s),clearTimeout(u.animationResetTimer),u.animationResetTimer=setTimeout(function(){u.animationTime=0,u.prevFromRect=null,u.fromRect=null,u.prevToRect=null,u.thisAnimationDuration=null},s),u.thisAnimationDuration=s)}),clearTimeout(e),r?e=setTimeout(function(){typeof a=="function"&&a()},l):typeof a=="function"&&a(),n=[]},animate:function(a,o,r,l){if(l){D(a,"transition",""),D(a,"transform","");var i=Je(this.el),s=i&&i.a,u=i&&i.d,y=(o.left-r.left)/(s||1),g=(o.top-r.top)/(u||1);a.animatingX=!!y,a.animatingY=!!g,D(a,"transform","translate3d("+y+"px,"+g+"px,0)"),this.forRepaintDummy=oo(a),D(a,"transition","transform "+l+"ms"+(this.options.easing?" "+this.options.easing:"")),D(a,"transform","translate3d(0,0,0)"),typeof a.animated=="number"&&clearTimeout(a.animated),a.animated=setTimeout(function(){D(a,"transition",""),D(a,"transform",""),a.animated=!1,a.animatingX=!1,a.animatingY=!1},l)}}}}function oo(n){return n.offsetWidth}function ro(n,e,t,a){return Math.sqrt(Math.pow(e.top-n.top,2)+Math.pow(e.left-n.left,2))/Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))*a.animation}var je=[],$t={initializeByDefault:!0},ct={mount:function(e){for(var t in $t)$t.hasOwnProperty(t)&&!(t in e)&&(e[t]=$t[t]);je.forEach(function(a){if(a.pluginName===e.pluginName)throw"Sortable: Cannot mount plugin ".concat(e.pluginName," more than once")}),je.push(e)},pluginEvent:function(e,t,a){var o=this;this.eventCanceled=!1,a.cancel=function(){o.eventCanceled=!0};var r=e+"Global";je.forEach(function(l){t[l.pluginName]&&(t[l.pluginName][r]&&t[l.pluginName][r](Pe({sortable:t},a)),t.options[l.pluginName]&&t[l.pluginName][e]&&t[l.pluginName][e](Pe({sortable:t},a)))})},initializePlugins:function(e,t,a,o){je.forEach(function(i){var s=i.pluginName;if(!(!e.options[s]&&!i.initializeByDefault)){var u=new i(e,t,e.options);u.sortable=e,u.options=e.options,e[s]=u,Ae(a,u.defaults)}});for(var r in e.options)if(e.options.hasOwnProperty(r)){var l=this.modifyOption(e,r,e.options[r]);typeof l<"u"&&(e.options[r]=l)}},getEventProperties:function(e,t){var a={};return je.forEach(function(o){typeof o.eventProperties=="function"&&Ae(a,o.eventProperties.call(t[o.pluginName],e))}),a},modifyOption:function(e,t,a){var o;return je.forEach(function(r){e[r.pluginName]&&r.optionListeners&&typeof r.optionListeners[t]=="function"&&(o=r.optionListeners[t].call(e[r.pluginName],a))}),o}};function lo(n){var e=n.sortable,t=n.rootEl,a=n.name,o=n.targetEl,r=n.cloneEl,l=n.toEl,i=n.fromEl,s=n.oldIndex,u=n.newIndex,y=n.oldDraggableIndex,g=n.newDraggableIndex,S=n.originalEvent,k=n.putSortable,C=n.extraEventProperties;if(e=e||t&&t[me],!!e){var f,W=e.options,j="on"+a.charAt(0).toUpperCase()+a.substr(1);window.CustomEvent&&!Ne&&!ut?f=new CustomEvent(a,{bubbles:!0,cancelable:!0}):(f=document.createEvent("Event"),f.initEvent(a,!0,!0)),f.to=l||t,f.from=i||t,f.item=o||t,f.clone=r,f.oldIndex=s,f.newIndex=u,f.oldDraggableIndex=y,f.newDraggableIndex=g,f.originalEvent=S,f.pullMode=k?k.lastPutMode:void 0;var w=Pe(Pe({},C),ct.getEventProperties(a,e));for(var P in w)f[P]=w[P];t&&t.dispatchEvent(f),W[j]&&W[j].call(e,f)}}var io=["evt"],ge=function(e,t){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},o=a.evt,r=Za(a,io);ct.pluginEvent.bind(x)(e,t,Pe({dragEl:p,parentEl:ee,ghostEl:O,rootEl:H,nextEl:He,lastDownEl:vt,cloneEl:Z,cloneHidden:Be,dragStarted:tt,putSortable:se,activeSortable:x.active,originalEvent:o,oldIndex:Qe,oldDraggableIndex:lt,newIndex:be,newDraggableIndex:Re,hideGhostForTarget:Fn,unhideGhostForTarget:Ln,cloneNowHidden:function(){Be=!0},cloneNowShown:function(){Be=!1},dispatchSortableEvent:function(i){fe({sortable:t,name:i,originalEvent:o})}},r))};function fe(n){lo(Pe({putSortable:se,cloneEl:Z,targetEl:p,rootEl:H,oldIndex:Qe,oldDraggableIndex:lt,newIndex:be,newDraggableIndex:Re},n))}var p,ee,O,H,He,vt,Z,Be,Qe,be,lt,Re,dt,se,Ke=!1,St=!1,kt=[],Ye,Se,At,Nt,vn,_n,tt,qe,it,st=!1,ft=!1,_t,ue,Mt=[],Wt=!1,Ct=[],xt=typeof document<"u",pt=Qt,bn=ut||Ne?"cssFloat":"float",so=xt&&!xn&&!Qt&&"draggable"in document.createElement("div"),Vn=function(){if(xt){if(Ne)return!1;var n=document.createElement("x");return n.style.cssText="pointer-events:auto",n.style.pointerEvents==="auto"}}(),Rn=function(e,t){var a=D(e),o=parseInt(a.width)-parseInt(a.paddingLeft)-parseInt(a.paddingRight)-parseInt(a.borderLeftWidth)-parseInt(a.borderRightWidth),r=et(e,0,t),l=et(e,1,t),i=r&&D(r),s=l&&D(l),u=i&&parseInt(i.marginLeft)+parseInt(i.marginRight)+re(r).width,y=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+re(l).width;if(a.display==="flex")return a.flexDirection==="column"||a.flexDirection==="column-reverse"?"vertical":"horizontal";if(a.display==="grid")return a.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(r&&i.float&&i.float!=="none"){var g=i.float==="left"?"left":"right";return l&&(s.clear==="both"||s.clear===g)?"vertical":"horizontal"}return r&&(i.display==="block"||i.display==="flex"||i.display==="table"||i.display==="grid"||u>=o&&a[bn]==="none"||l&&a[bn]==="none"&&u+y>o)?"vertical":"horizontal"},uo=function(e,t,a){var o=a?e.left:e.top,r=a?e.right:e.bottom,l=a?e.width:e.height,i=a?t.left:t.top,s=a?t.right:t.bottom,u=a?t.width:t.height;return o===i||r===s||o+l/2===i+u/2},co=function(e,t){var a;return kt.some(function(o){var r=o[me].options.emptyInsertThreshold;if(!(!r||Zt(o))){var l=re(o),i=e>=l.left-r&&e<=l.right+r,s=t>=l.top-r&&t<=l.bottom+r;if(i&&s)return a=o}}),a},Bn=function(e){function t(r,l){return function(i,s,u,y){var g=i.options.group.name&&s.options.group.name&&i.options.group.name===s.options.group.name;if(r==null&&(l||g))return!0;if(r==null||r===!1)return!1;if(l&&r==="clone")return r;if(typeof r=="function")return t(r(i,s,u,y),l)(i,s,u,y);var S=(l?i:s).options.group.name;return r===!0||typeof r=="string"&&r===S||r.join&&r.indexOf(S)>-1}}var a={},o=e.group;(!o||mt(o)!="object")&&(o={name:o}),a.name=o.name,a.checkPull=t(o.pull,!0),a.checkPut=t(o.put),a.revertClone=o.revertClone,e.group=a},Fn=function(){!Vn&&O&&D(O,"display","none")},Ln=function(){!Vn&&O&&D(O,"display","")};xt&&!xn&&document.addEventListener("click",function(n){if(St)return n.preventDefault(),n.stopPropagation&&n.stopPropagation(),n.stopImmediatePropagation&&n.stopImmediatePropagation(),St=!1,!1},!0);var Ue=function(e){if(p){e=e.touches?e.touches[0]:e;var t=co(e.clientX,e.clientY);if(t){var a={};for(var o in e)e.hasOwnProperty(o)&&(a[o]=e[o]);a.target=a.rootEl=t,a.preventDefault=void 0,a.stopPropagation=void 0,t[me]._onDragOver(a)}}},fo=function(e){p&&p.parentNode[me]._isOutsideThisEl(e.target)};function x(n,e){if(!(n&&n.nodeType&&n.nodeType===1))throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(n));this.el=n,this.options=e=Ae({},e),n[me]=this;var t={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(n.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Rn(n,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(l,i){l.setData("Text",i.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:x.supportPointer!==!1&&"PointerEvent"in window&&(!ot||Qt),emptyInsertThreshold:5};ct.initializePlugins(this,n,t);for(var a in t)!(a in e)&&(e[a]=t[a]);Bn(e);for(var o in this)o.charAt(0)==="_"&&typeof this[o]=="function"&&(this[o]=this[o].bind(this));this.nativeDraggable=e.forceFallback?!1:so,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?V(n,"pointerdown",this._onTapStart):(V(n,"mousedown",this._onTapStart),V(n,"touchstart",this._onTapStart)),this.nativeDraggable&&(V(n,"dragover",this),V(n,"dragenter",this)),kt.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),Ae(this,ao())}x.prototype={constructor:x,_isOutsideThisEl:function(e){!this.el.contains(e)&&e!==this.el&&(qe=null)},_getDirection:function(e,t){return typeof this.options.direction=="function"?this.options.direction.call(this,e,t,p):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,a=this.el,o=this.options,r=o.preventOnFilter,l=e.type,i=e.touches&&e.touches[0]||e.pointerType&&e.pointerType==="touch"&&e,s=(i||e).target,u=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||s,y=o.filter;if(yo(a),!p&&!(/mousedown|pointerdown/.test(l)&&e.button!==0||o.disabled)&&!u.isContentEditable&&!(!this.nativeDraggable&&ot&&s&&s.tagName.toUpperCase()==="SELECT")&&(s=ke(s,o.draggable,a,!1),!(s&&s.animated)&&vt!==s)){if(Qe=Te(s),lt=Te(s,o.draggable),typeof y=="function"){if(y.call(this,e,s,this)){fe({sortable:t,rootEl:u,name:"filter",targetEl:s,toEl:a,fromEl:a}),ge("filter",t,{evt:e}),r&&e.preventDefault();return}}else if(y&&(y=y.split(",").some(function(g){if(g=ke(u,g.trim(),a,!1),g)return fe({sortable:t,rootEl:g,name:"filter",targetEl:s,fromEl:a,toEl:a}),ge("filter",t,{evt:e}),!0}),y)){r&&e.preventDefault();return}o.handle&&!ke(u,o.handle,a,!1)||this._prepareDragStart(e,i,s)}}},_prepareDragStart:function(e,t,a){var o=this,r=o.el,l=o.options,i=r.ownerDocument,s;if(a&&!p&&a.parentNode===r){var u=re(a);if(H=r,p=a,ee=p.parentNode,He=p.nextSibling,vt=a,dt=l.group,x.dragged=p,Ye={target:p,clientX:(t||e).clientX,clientY:(t||e).clientY},vn=Ye.clientX-u.left,_n=Ye.clientY-u.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,p.style["will-change"]="all",s=function(){if(ge("delayEnded",o,{evt:e}),x.eventCanceled){o._onDrop();return}o._disableDelayedDragEvents(),!pn&&o.nativeDraggable&&(p.draggable=!0),o._triggerDragStart(e,t),fe({sortable:o,name:"choose",originalEvent:e}),_e(p,l.chosenClass,!0)},l.ignore.split(",").forEach(function(y){On(p,y.trim(),Vt)}),V(i,"dragover",Ue),V(i,"mousemove",Ue),V(i,"touchmove",Ue),l.supportPointer?(V(i,"pointerup",o._onDrop),!this.nativeDraggable&&V(i,"pointercancel",o._onDrop)):(V(i,"mouseup",o._onDrop),V(i,"touchend",o._onDrop),V(i,"touchcancel",o._onDrop)),pn&&this.nativeDraggable&&(this.options.touchStartThreshold=4,p.draggable=!0),ge("delayStart",this,{evt:e}),l.delay&&(!l.delayOnTouchOnly||t)&&(!this.nativeDraggable||!(ut||Ne))){if(x.eventCanceled){this._onDrop();return}l.supportPointer?(V(i,"pointerup",o._disableDelayedDrag),V(i,"pointercancel",o._disableDelayedDrag)):(V(i,"mouseup",o._disableDelayedDrag),V(i,"touchend",o._disableDelayedDrag),V(i,"touchcancel",o._disableDelayedDrag)),V(i,"mousemove",o._delayedDragTouchMoveHandler),V(i,"touchmove",o._delayedDragTouchMoveHandler),l.supportPointer&&V(i,"pointermove",o._delayedDragTouchMoveHandler),o._dragStartTimer=setTimeout(s,l.delay)}else s()}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){p&&Vt(p),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;A(e,"mouseup",this._disableDelayedDrag),A(e,"touchend",this._disableDelayedDrag),A(e,"touchcancel",this._disableDelayedDrag),A(e,"pointerup",this._disableDelayedDrag),A(e,"pointercancel",this._disableDelayedDrag),A(e,"mousemove",this._delayedDragTouchMoveHandler),A(e,"touchmove",this._delayedDragTouchMoveHandler),A(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||e.pointerType=="touch"&&e,!this.nativeDraggable||t?this.options.supportPointer?V(document,"pointermove",this._onTouchMove):t?V(document,"touchmove",this._onTouchMove):V(document,"mousemove",this._onTouchMove):(V(p,"dragend",this),V(H,"dragstart",this._onDragStart));try{document.selection?bt(function(){document.selection.empty()}):window.getSelection().removeAllRanges()}catch{}},_dragStarted:function(e,t){if(Ke=!1,H&&p){ge("dragStarted",this,{evt:t}),this.nativeDraggable&&V(document,"dragover",fo);var a=this.options;!e&&_e(p,a.dragClass,!1),_e(p,a.ghostClass,!0),x.active=this,e&&this._appendGhost(),fe({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(Se){this._lastX=Se.clientX,this._lastY=Se.clientY,Fn();for(var e=document.elementFromPoint(Se.clientX,Se.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(Se.clientX,Se.clientY),e!==t);)t=e;if(p.parentNode[me]._isOutsideThisEl(e),t)do{if(t[me]){var a=void 0;if(a=t[me]._onDragOver({clientX:Se.clientX,clientY:Se.clientY,target:e,rootEl:t}),a&&!this.options.dragoverBubble)break}e=t}while(t=In(t));Ln()}},_onTouchMove:function(e){if(Ye){var t=this.options,a=t.fallbackTolerance,o=t.fallbackOffset,r=e.touches?e.touches[0]:e,l=O&&Je(O,!0),i=O&&l&&l.a,s=O&&l&&l.d,u=pt&&ue&&mn(ue),y=(r.clientX-Ye.clientX+o.x)/(i||1)+(u?u[0]-Mt[0]:0)/(i||1),g=(r.clientY-Ye.clientY+o.y)/(s||1)+(u?u[1]-Mt[1]:0)/(s||1);if(!x.active&&!Ke){if(a&&Math.max(Math.abs(r.clientX-this._lastX),Math.abs(r.clientY-this._lastY))<a)return;this._onDragStart(e,!0)}if(O){l?(l.e+=y-(At||0),l.f+=g-(Nt||0)):l={a:1,b:0,c:0,d:1,e:y,f:g};var S="matrix(".concat(l.a,",").concat(l.b,",").concat(l.c,",").concat(l.d,",").concat(l.e,",").concat(l.f,")");D(O,"webkitTransform",S),D(O,"mozTransform",S),D(O,"msTransform",S),D(O,"transform",S),At=y,Nt=g,Se=r}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!O){var e=this.options.fallbackOnBody?document.body:H,t=re(p,!0,pt,!0,e),a=this.options;if(pt){for(ue=e;D(ue,"position")==="static"&&D(ue,"transform")==="none"&&ue!==document;)ue=ue.parentNode;ue!==document.body&&ue!==document.documentElement?(ue===document&&(ue=xe()),t.top+=ue.scrollTop,t.left+=ue.scrollLeft):ue=xe(),Mt=mn(ue)}O=p.cloneNode(!0),_e(O,a.ghostClass,!1),_e(O,a.fallbackClass,!0),_e(O,a.dragClass,!0),D(O,"transition",""),D(O,"transform",""),D(O,"box-sizing","border-box"),D(O,"margin",0),D(O,"top",t.top),D(O,"left",t.left),D(O,"width",t.width),D(O,"height",t.height),D(O,"opacity","0.8"),D(O,"position",pt?"absolute":"fixed"),D(O,"zIndex","100000"),D(O,"pointerEvents","none"),x.ghost=O,e.appendChild(O),D(O,"transform-origin",vn/parseInt(O.style.width)*100+"% "+_n/parseInt(O.style.height)*100+"%")}},_onDragStart:function(e,t){var a=this,o=e.dataTransfer,r=a.options;if(ge("dragStart",this,{evt:e}),x.eventCanceled){this._onDrop();return}ge("setupClone",this),x.eventCanceled||(Z=Nn(p),Z.removeAttribute("id"),Z.draggable=!1,Z.style["will-change"]="",this._hideClone(),_e(Z,this.options.chosenClass,!1),x.clone=Z),a.cloneId=bt(function(){ge("clone",a),!x.eventCanceled&&(a.options.removeCloneOnHide||H.insertBefore(Z,p),a._hideClone(),fe({sortable:a,name:"clone"}))}),!t&&_e(p,r.dragClass,!0),t?(St=!0,a._loopId=setInterval(a._emulateDragOver,50)):(A(document,"mouseup",a._onDrop),A(document,"touchend",a._onDrop),A(document,"touchcancel",a._onDrop),o&&(o.effectAllowed="move",r.setData&&r.setData.call(a,o,p)),V(document,"drop",a),D(p,"transform","translateZ(0)")),Ke=!0,a._dragStartId=bt(a._dragStarted.bind(a,t,e)),V(document,"selectstart",a),tt=!0,window.getSelection().removeAllRanges(),ot&&D(document.body,"user-select","none")},_onDragOver:function(e){var t=this.el,a=e.target,o,r,l,i=this.options,s=i.group,u=x.active,y=dt===s,g=i.sort,S=se||u,k,C=this,f=!1;if(Wt)return;function W(v,$){ge(v,C,Pe({evt:e,isOwner:y,axis:k?"vertical":"horizontal",revert:l,dragRect:o,targetRect:r,canSort:g,fromSortable:S,target:a,completed:w,onMove:function(ae,J){return ht(H,t,p,o,ae,re(ae),e,J)},changed:P},$))}function j(){W("dragOverAnimationCapture"),C.captureAnimationState(),C!==S&&S.captureAnimationState()}function w(v){return W("dragOverCompleted",{insertion:v}),v&&(y?u._hideClone():u._showClone(C),C!==S&&(_e(p,se?se.options.ghostClass:u.options.ghostClass,!1),_e(p,i.ghostClass,!0)),se!==C&&C!==x.active?se=C:C===x.active&&se&&(se=null),S===C&&(C._ignoreWhileAnimating=a),C.animateAll(function(){W("dragOverAnimationComplete"),C._ignoreWhileAnimating=null}),C!==S&&(S.animateAll(),S._ignoreWhileAnimating=null)),(a===p&&!p.animated||a===t&&!a.animated)&&(qe=null),!i.dragoverBubble&&!e.rootEl&&a!==document&&(p.parentNode[me]._isOutsideThisEl(e.target),!v&&Ue(e)),!i.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),f=!0}function P(){be=Te(p),Re=Te(p,i.draggable),fe({sortable:C,name:"change",toEl:t,newIndex:be,newDraggableIndex:Re,originalEvent:e})}if(e.preventDefault!==void 0&&e.cancelable&&e.preventDefault(),a=ke(a,i.draggable,t,!0),W("dragOver"),x.eventCanceled)return f;if(p.contains(e.target)||a.animated&&a.animatingX&&a.animatingY||C._ignoreWhileAnimating===a)return w(!1);if(St=!1,u&&!i.disabled&&(y?g||(l=ee!==H):se===this||(this.lastPutMode=dt.checkPull(this,u,p,e))&&s.checkPut(this,u,p,e))){if(k=this._getDirection(e,a)==="vertical",o=re(p),W("dragOverValid"),x.eventCanceled)return f;if(l)return ee=H,j(),this._hideClone(),W("revert"),x.eventCanceled||(He?H.insertBefore(p,He):H.appendChild(p)),w(!0);var I=Zt(t,i.draggable);if(!I||mo(e,k,this)&&!I.animated){if(I===p)return w(!1);if(I&&t===e.target&&(a=I),a&&(r=re(a)),ht(H,t,p,o,a,r,e,!!a)!==!1)return j(),I&&I.nextSibling?t.insertBefore(p,I.nextSibling):t.appendChild(p),ee=t,P(),w(!0)}else if(I&&go(e,k,this)){var F=et(t,0,i,!0);if(F===p)return w(!1);if(a=F,r=re(a),ht(H,t,p,o,a,r,e,!1)!==!1)return j(),t.insertBefore(p,F),ee=t,P(),w(!0)}else if(a.parentNode===t){r=re(a);var N=0,U,ne=p.parentNode!==t,q=!uo(p.animated&&p.toRect||o,a.animated&&a.toRect||r,k),pe=k?"top":"left",he=gn(a,"top","top")||gn(p,"top","top"),ye=he?he.scrollTop:void 0;qe!==a&&(U=r[pe],st=!1,ft=!q&&i.invertSwap||ne),N=vo(e,a,r,k,q?1:i.swapThreshold,i.invertedSwapThreshold==null?i.swapThreshold:i.invertedSwapThreshold,ft,qe===a);var ie;if(N!==0){var ce=Te(p);do ce-=N,ie=ee.children[ce];while(ie&&(D(ie,"display")==="none"||ie===O))}if(N===0||ie===a)return w(!1);qe=a,it=N;var M=a.nextElementSibling,E=!1;E=N===1;var h=ht(H,t,p,o,a,r,e,E);if(h!==!1)return(h===1||h===-1)&&(E=h===1),Wt=!0,setTimeout(ho,30),j(),E&&!M?t.appendChild(p):a.parentNode.insertBefore(p,E?M:a),he&&An(he,0,ye-he.scrollTop),ee=p.parentNode,U!==void 0&&!ft&&(_t=Math.abs(U-re(a)[pe])),P(),w(!0)}if(t.contains(p))return w(!1)}return!1},_ignoreWhileAnimating:null,_offMoveEvents:function(){A(document,"mousemove",this._onTouchMove),A(document,"touchmove",this._onTouchMove),A(document,"pointermove",this._onTouchMove),A(document,"dragover",Ue),A(document,"mousemove",Ue),A(document,"touchmove",Ue)},_offUpEvents:function(){var e=this.el.ownerDocument;A(e,"mouseup",this._onDrop),A(e,"touchend",this._onDrop),A(e,"pointerup",this._onDrop),A(e,"pointercancel",this._onDrop),A(e,"touchcancel",this._onDrop),A(document,"selectstart",this)},_onDrop:function(e){var t=this.el,a=this.options;if(be=Te(p),Re=Te(p,a.draggable),ge("drop",this,{evt:e}),ee=p&&p.parentNode,be=Te(p),Re=Te(p,a.draggable),x.eventCanceled){this._nulling();return}Ke=!1,ft=!1,st=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),Xt(this.cloneId),Xt(this._dragStartId),this.nativeDraggable&&(A(document,"drop",this),A(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),ot&&D(document.body,"user-select",""),D(p,"transform",""),e&&(tt&&(e.cancelable&&e.preventDefault(),!a.dropBubble&&e.stopPropagation()),O&&O.parentNode&&O.parentNode.removeChild(O),(H===ee||se&&se.lastPutMode!=="clone")&&Z&&Z.parentNode&&Z.parentNode.removeChild(Z),p&&(this.nativeDraggable&&A(p,"dragend",this),Vt(p),p.style["will-change"]="",tt&&!Ke&&_e(p,se?se.options.ghostClass:this.options.ghostClass,!1),_e(p,this.options.chosenClass,!1),fe({sortable:this,name:"unchoose",toEl:ee,newIndex:null,newDraggableIndex:null,originalEvent:e}),H!==ee?(be>=0&&(fe({rootEl:ee,name:"add",toEl:ee,fromEl:H,originalEvent:e}),fe({sortable:this,name:"remove",toEl:ee,originalEvent:e}),fe({rootEl:ee,name:"sort",toEl:ee,fromEl:H,originalEvent:e}),fe({sortable:this,name:"sort",toEl:ee,originalEvent:e})),se&&se.save()):be!==Qe&&be>=0&&(fe({sortable:this,name:"update",toEl:ee,originalEvent:e}),fe({sortable:this,name:"sort",toEl:ee,originalEvent:e})),x.active&&((be==null||be===-1)&&(be=Qe,Re=lt),fe({sortable:this,name:"end",toEl:ee,originalEvent:e}),this.save()))),this._nulling()},_nulling:function(){ge("nulling",this),H=p=ee=O=He=Z=vt=Be=Ye=Se=tt=be=Re=Qe=lt=qe=it=se=dt=x.dragged=x.ghost=x.clone=x.active=null,Ct.forEach(function(e){e.checked=!0}),Ct.length=At=Nt=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":p&&(this._onDragOver(e),po(e));break;case"selectstart":e.preventDefault();break}},toArray:function(){for(var e=[],t,a=this.el.children,o=0,r=a.length,l=this.options;o<r;o++)t=a[o],ke(t,l.draggable,this.el,!1)&&e.push(t.getAttribute(l.dataIdAttr)||bo(t));return e},sort:function(e,t){var a={},o=this.el;this.toArray().forEach(function(r,l){var i=o.children[l];ke(i,this.options.draggable,o,!1)&&(a[r]=i)},this),t&&this.captureAnimationState(),e.forEach(function(r){a[r]&&(o.removeChild(a[r]),o.appendChild(a[r]))}),t&&this.animateAll()},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return ke(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var a=this.options;if(t===void 0)return a[e];var o=ct.modifyOption(this,e,t);typeof o<"u"?a[e]=o:a[e]=t,e==="group"&&Bn(a)},destroy:function(){ge("destroy",this);var e=this.el;e[me]=null,A(e,"mousedown",this._onTapStart),A(e,"touchstart",this._onTapStart),A(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(A(e,"dragover",this),A(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),function(t){t.removeAttribute("draggable")}),this._onDrop(),this._disableDelayedDragEvents(),kt.splice(kt.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!Be){if(ge("hideClone",this),x.eventCanceled)return;D(Z,"display","none"),this.options.removeCloneOnHide&&Z.parentNode&&Z.parentNode.removeChild(Z),Be=!0}},_showClone:function(e){if(e.lastPutMode!=="clone"){this._hideClone();return}if(Be){if(ge("showClone",this),x.eventCanceled)return;p.parentNode==H&&!this.options.group.revertClone?H.insertBefore(Z,p):He?H.insertBefore(Z,He):H.appendChild(Z),this.options.group.revertClone&&this.animate(p,Z),D(Z,"display",""),Be=!1}}};function po(n){n.dataTransfer&&(n.dataTransfer.dropEffect="move"),n.cancelable&&n.preventDefault()}function ht(n,e,t,a,o,r,l,i){var s,u=n[me],y=u.options.onMove,g;return window.CustomEvent&&!Ne&&!ut?s=new CustomEvent("move",{bubbles:!0,cancelable:!0}):(s=document.createEvent("Event"),s.initEvent("move",!0,!0)),s.to=e,s.from=n,s.dragged=t,s.draggedRect=a,s.related=o||e,s.relatedRect=r||re(e),s.willInsertAfter=i,s.originalEvent=l,n.dispatchEvent(s),y&&(g=y.call(u,s,l)),g}function Vt(n){n.draggable=!1}function ho(){Wt=!1}function go(n,e,t){var a=re(et(t.el,0,t.options,!0)),o=Mn(t.el,t.options,O),r=10;return e?n.clientX<o.left-r||n.clientY<a.top&&n.clientX<a.right:n.clientY<o.top-r||n.clientY<a.bottom&&n.clientX<a.left}function mo(n,e,t){var a=re(Zt(t.el,t.options.draggable)),o=Mn(t.el,t.options,O),r=10;return e?n.clientX>o.right+r||n.clientY>a.bottom&&n.clientX>a.left:n.clientY>o.bottom+r||n.clientX>a.right&&n.clientY>a.top}function vo(n,e,t,a,o,r,l,i){var s=a?n.clientY:n.clientX,u=a?t.height:t.width,y=a?t.top:t.left,g=a?t.bottom:t.right,S=!1;if(!l){if(i&&_t<u*o){if(!st&&(it===1?s>y+u*r/2:s<g-u*r/2)&&(st=!0),st)S=!0;else if(it===1?s<y+_t:s>g-_t)return-it}else if(s>y+u*(1-o)/2&&s<g-u*(1-o)/2)return _o(e)}return S=S||l,S&&(s<y+u*r/2||s>g-u*r/2)?s>y+u/2?1:-1:0}function _o(n){return Te(p)<Te(n)?1:-1}function bo(n){for(var e=n.tagName+n.className+n.src+n.href+n.textContent,t=e.length,a=0;t--;)a+=e.charCodeAt(t);return a.toString(36)}function yo(n){Ct.length=0;for(var e=n.getElementsByTagName("input"),t=e.length;t--;){var a=e[t];a.checked&&Ct.push(a)}}function bt(n){return setTimeout(n,0)}function Xt(n){return clearTimeout(n)}xt&&V(document,"touchmove",function(n){(x.active||Ke)&&n.cancelable&&n.preventDefault()});x.utils={on:V,off:A,css:D,find:On,is:function(e,t){return!!ke(e,t,e,!1)},extend:to,throttle:$n,closest:ke,toggleClass:_e,clone:Nn,index:Te,nextTick:bt,cancelNextTick:Xt,detectDirection:Rn,getChild:et,expando:me};x.get=function(n){return n[me]};x.mount=function(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];e[0].constructor===Array&&(e=e[0]),e.forEach(function(a){if(!a.prototype||!a.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(a));a.utils&&(x.utils=Pe(Pe({},x.utils),a.utils)),ct.mount(a)})};x.create=function(n,e){return new x(n,e)};x.version=Ja;var oe=[],nt,Yt,Ut=!1,Rt,Bt,Dt,at;function wo(){function n(){this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0};for(var e in this)e.charAt(0)==="_"&&typeof this[e]=="function"&&(this[e]=this[e].bind(this))}return n.prototype={dragStarted:function(t){var a=t.originalEvent;this.sortable.nativeDraggable?V(document,"dragover",this._handleAutoScroll):this.options.supportPointer?V(document,"pointermove",this._handleFallbackAutoScroll):a.touches?V(document,"touchmove",this._handleFallbackAutoScroll):V(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(t){var a=t.originalEvent;!this.options.dragOverBubble&&!a.rootEl&&this._handleAutoScroll(a)},drop:function(){this.sortable.nativeDraggable?A(document,"dragover",this._handleAutoScroll):(A(document,"pointermove",this._handleFallbackAutoScroll),A(document,"touchmove",this._handleFallbackAutoScroll),A(document,"mousemove",this._handleFallbackAutoScroll)),yn(),yt(),no()},nulling:function(){Dt=Yt=nt=Ut=at=Rt=Bt=null,oe.length=0},_handleFallbackAutoScroll:function(t){this._handleAutoScroll(t,!0)},_handleAutoScroll:function(t,a){var o=this,r=(t.touches?t.touches[0]:t).clientX,l=(t.touches?t.touches[0]:t).clientY,i=document.elementFromPoint(r,l);if(Dt=t,a||this.options.forceAutoScrollFallback||ut||Ne||ot){Ft(t,this.options,i,a);var s=Le(i,!0);Ut&&(!at||r!==Rt||l!==Bt)&&(at&&yn(),at=setInterval(function(){var u=Le(document.elementFromPoint(r,l),!0);u!==s&&(s=u,yt()),Ft(t,o.options,u,a)},10),Rt=r,Bt=l)}else{if(!this.options.bubbleScroll||Le(i,!0)===xe()){yt();return}Ft(t,this.options,Le(i,!1),!1)}}},Ae(n,{pluginName:"scroll",initializeByDefault:!0})}function yt(){oe.forEach(function(n){clearInterval(n.pid)}),oe=[]}function yn(){clearInterval(at)}var Ft=$n(function(n,e,t,a){if(e.scroll){var o=(n.touches?n.touches[0]:n).clientX,r=(n.touches?n.touches[0]:n).clientY,l=e.scrollSensitivity,i=e.scrollSpeed,s=xe(),u=!1,y;Yt!==t&&(Yt=t,yt(),nt=e.scroll,y=e.scrollFn,nt===!0&&(nt=Le(t,!0)));var g=0,S=nt;do{var k=S,C=re(k),f=C.top,W=C.bottom,j=C.left,w=C.right,P=C.width,I=C.height,F=void 0,N=void 0,U=k.scrollWidth,ne=k.scrollHeight,q=D(k),pe=k.scrollLeft,he=k.scrollTop;k===s?(F=P<U&&(q.overflowX==="auto"||q.overflowX==="scroll"||q.overflowX==="visible"),N=I<ne&&(q.overflowY==="auto"||q.overflowY==="scroll"||q.overflowY==="visible")):(F=P<U&&(q.overflowX==="auto"||q.overflowX==="scroll"),N=I<ne&&(q.overflowY==="auto"||q.overflowY==="scroll"));var ye=F&&(Math.abs(w-o)<=l&&pe+P<U)-(Math.abs(j-o)<=l&&!!pe),ie=N&&(Math.abs(W-r)<=l&&he+I<ne)-(Math.abs(f-r)<=l&&!!he);if(!oe[g])for(var ce=0;ce<=g;ce++)oe[ce]||(oe[ce]={});(oe[g].vx!=ye||oe[g].vy!=ie||oe[g].el!==k)&&(oe[g].el=k,oe[g].vx=ye,oe[g].vy=ie,clearInterval(oe[g].pid),(ye!=0||ie!=0)&&(u=!0,oe[g].pid=setInterval((function(){a&&this.layer===0&&x.active._onTouchMove(Dt);var M=oe[this.layer].vy?oe[this.layer].vy*i:0,E=oe[this.layer].vx?oe[this.layer].vx*i:0;typeof y=="function"&&y.call(x.dragged.parentNode[me],E,M,n,Dt,oe[this.layer].el)!=="continue"||An(oe[this.layer].el,E,M)}).bind({layer:g}),24))),g++}while(e.bubbleScroll&&S!==s&&(S=Le(S,!1)));Ut=u}},30),zn=function(e){var t=e.originalEvent,a=e.putSortable,o=e.dragEl,r=e.activeSortable,l=e.dispatchSortableEvent,i=e.hideGhostForTarget,s=e.unhideGhostForTarget;if(t){var u=a||r;i();var y=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,g=document.elementFromPoint(y.clientX,y.clientY);s(),u&&!u.el.contains(g)&&(l("spill"),this.onSpill({dragEl:o,putSortable:a}))}};function Jt(){}Jt.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,a=e.putSortable;this.sortable.captureAnimationState(),a&&a.captureAnimationState();var o=et(this.sortable.el,this.startIndex,this.options);o?this.sortable.el.insertBefore(t,o):this.sortable.el.appendChild(t),this.sortable.animateAll(),a&&a.animateAll()},drop:zn};Ae(Jt,{pluginName:"revertOnSpill"});function en(){}en.prototype={onSpill:function(e){var t=e.dragEl,a=e.putSortable,o=a||this.sortable;o.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),o.animateAll()},drop:zn};Ae(en,{pluginName:"removeOnSpill"});x.mount(new wo);x.mount(en,Jt);const To={class:"tasks-view"},Eo={class:"page-header"},So={class:"header-actions"},ko={class:"toolbar"},Co={class:"toolbar-left"},Do={class:"toolbar-right"},xo={class:"task-list-container"},Po={class:"task-name"},Io=["href","title"],Oo={class:"share-link-container"},$o=["href","title"],Ao={key:1,class:"no-share"},No=["title"],Mo=["title"],Vo={class:"advanced-features"},Ro={key:3,class:"no-advanced"},Bo={class:"mobile-cards"},Fo={key:0,class:"empty-state"},Lo={class:"task-card-body"},zo={class:"card-header"},Wo={class:"task-info"},Xo={class:"task-name"},Yo=["href"],Uo={class:"task-order"},Ho={class:"card-content"},Go={class:"content-row"},jo={class:"value"},qo={key:0,class:"content-row"},Ko={class:"value"},Qo={key:1,class:"content-row"},Zo={class:"value"},Jo={key:2,class:"content-row"},er={class:"advanced-tags"},tr={key:3,class:"content-row"},nr=["href"],ar={class:"card-actions"},or=["onClick","disabled","title"],rr=["onClick"],lr=["onClick"],ir=["onClick"],sr=qt({__name:"TasksView",setup(n){const e=Ht(),{tasks:t,loading:a}=jt(e),{executeTask:o,executeBatchTasks:r,deleteTask:l,deleteBatchTasks:i,shareTask:s,moveTask:u,initTasks:y}=pa(),g=Y(),S=Y(""),k=Y("all"),C=Y("all"),f=Y(!1),W=Y([]),j=Y(!1),w=Y(null),P=Y(!1),I=Y(null),F=Y(-1),N=Y(!1);let U=null;const ne=ze(()=>{const T=t.value.map(d=>d.category).filter(d=>d&&d.trim());return[...new Set(T)]}),q=ze(()=>{let T=t.value;if(S.value){const d=S.value.toLowerCase();T=T.filter(B=>{var ve,Me;return((ve=B.name)==null?void 0:ve.toLowerCase().includes(d))||B.url.toLowerCase().includes(d)||B.save_dir.toLowerCase().includes(d)||((Me=B.category)==null?void 0:Me.toLowerCase().includes(d))})}return k.value!=="all"&&(T=T.filter(d=>d.status===k.value)),C.value!=="all"&&(T=T.filter(d=>d.category===C.value)),f.value&&(T=[...T].reverse()),T}),pe=Un(()=>{},300),he=()=>{f.value=!f.value},ye=T=>{W.value=T},ie=async T=>{const d=t.value.find(B=>B.order-1===T);if(!d){z.error("任务不存在");return}if(d.status==="running"){z.warning("任务正在执行中");return}I.value=d,F.value=T,P.value=!0,o(T).catch(B=>{console.error("任务执行失败:",B)})},ce=async()=>{const T=W.value.map(d=>d.order-1);await r(T)},M=async T=>{await l(T)},E=async()=>{const T=W.value.map(d=>d.order-1);await i(T)},h=async T=>{try{const d=await s(T);gt.alert(`分享链接：${d.url}
${d.password?`密码：${d.password}`:""}`,"分享信息",{confirmButtonText:"复制链接",callback:async()=>{try{await navigator.clipboard.writeText(d.url),z.success("链接已复制到剪贴板")}catch{z.warning("复制失败，请手动复制")}}})}catch{}},v=()=>{w.value=null,j.value=!0},$=T=>{w.value=T,j.value=!0},L=()=>{w.value=null},ae=T=>{T||(w.value=null)},J=T=>{e.fetchTasks()},Ce=()=>{z.info("任务已取消")},Ge=()=>{I.value=null,F.value=-1},de=async()=>{var d,B;await Ze();const T=(B=(d=g.value)==null?void 0:d.$el)==null?void 0:B.querySelector(".el-table__body-wrapper tbody");T&&(U&&U.destroy(),U=x.create(T,{animation:300,ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",handle:".drag-handle",onStart:()=>{N.value=!0},onEnd:async ve=>{N.value=!1;const{oldIndex:Me,newIndex:Ee}=ve;if(!(Me===void 0||Ee===void 0||Me===Ee))try{const Xe=q.value[Me];Xe&&await u(Xe.order-1,Ee)}catch(Xe){console.error("任务排序失败:",Xe)}}}))},Ie=T=>{if(!T.url)return"";if(T.url.includes("?pwd=")||T.url.includes("&pwd="))return T.url;if(T.pwd&&T.pwd.trim()!==""){const d=T.url.includes("?")?"&":"?";return`${T.url}${d}pwd=${T.pwd}`}return T.url},We=T=>{if(!T)return"";const d=T.url;if(T.password){if(d.includes("?pwd=")||d.includes("&pwd="))return d;const B=d.includes("?")?"&":"?";return`${d}${B}pwd=${T.password}`}return d},K=async T=>{const d=We(T);if(d)try{await navigator.clipboard.writeText(d),z.success("分享链接已复制到剪贴板")}catch{z.warning("复制失败，请手动复制")}},tn=T=>({normal:"info",running:"warning",success:"success",error:"danger"})[T]||"info",nn=T=>wn(T),an=()=>{v()};return Gn(async()=>{await y(),await de(),window.addEventListener("global-add-task",an)}),Tn(()=>{window.removeEventListener("global-add-task",an)}),Fe(t,async()=>{t.value.length>0&&(await Ze(),await de())},{deep:!0}),(T,d)=>{const B=Dn,ve=Kt,Me=kn,Ee=ua,Xe=aa,on=oa,De=da,Ve=Cn,Wn=la,rn=ra;return R(),te("div",To,[m("div",Eo,[d[6]||(d[6]=m("h1",{class:"page-title"},"任务管理",-1)),m("div",So,[c(ve,{type:"primary",onClick:v},{default:b(()=>[c(B,null,{default:b(()=>[c(Q(ia))]),_:1}),d[5]||(d[5]=G(" 添加任务 ",-1))]),_:1})])]),m("div",ko,[m("div",Co,[c(Me,{modelValue:S.value,"onUpdate:modelValue":d[0]||(d[0]=_=>S.value=_),placeholder:"搜索任务...",clearable:"",style:{width:"300px"},onInput:Q(pe)},{prefix:b(()=>[c(B,null,{default:b(()=>[c(Q(sa))]),_:1})]),_:1},8,["modelValue","onInput"]),c(Xe,{modelValue:k.value,"onUpdate:modelValue":d[1]||(d[1]=_=>k.value=_),placeholder:"状态筛选",style:{width:"120px"}},{default:b(()=>[c(Ee,{label:"全部",value:"all"}),c(Ee,{label:"正常",value:"normal"}),c(Ee,{label:"运行中",value:"running"}),c(Ee,{label:"成功",value:"success"}),c(Ee,{label:"错误",value:"error"})]),_:1},8,["modelValue"]),c(Xe,{modelValue:C.value,"onUpdate:modelValue":d[2]||(d[2]=_=>C.value=_),placeholder:"分类筛选",style:{width:"140px"}},{default:b(()=>[c(Ee,{label:"全部分类",value:"all"}),(R(!0),te(wt,null,Tt(ne.value,_=>(R(),we(Ee,{key:_,label:_,value:_},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),c(ve,{onClick:he,type:f.value?"primary":"",size:"default"},{default:b(()=>[c(B,null,{default:b(()=>[c(Q(ca))]),_:1}),G(" "+X(f.value?"倒序":"正序"),1)]),_:1},8,["type"])]),m("div",Do,[W.value.length>0?(R(),we(on,{key:0},{default:b(()=>[c(ve,{onClick:ce},{default:b(()=>[c(B,null,{default:b(()=>[c(Q(Pt))]),_:1}),G(" 批量执行 ("+X(W.value.length)+") ",1)]),_:1}),c(ve,{onClick:E},{default:b(()=>[c(B,null,{default:b(()=>[c(Q(It))]),_:1}),d[7]||(d[7]=G(" 批量删除 ",-1))]),_:1})]),_:1})):le("",!0)])]),m("div",xo,[ln((R(),we(Wn,{ref_key:"tableRef",ref:g,data:q.value,stripe:"","row-key":"order",onSelectionChange:ye,class:"desktop-table"},{default:b(()=>[c(De,{type:"selection",width:"55"}),c(De,{label:"排序",width:"60",align:"center"},{default:b(()=>[m("div",{class:En(["drag-handle",{dragging:N.value}])},[c(B,null,{default:b(()=>[c(Q(fa))]),_:1})],2)]),_:1}),c(De,{prop:"order",label:"序号",width:"80"}),c(De,{prop:"name",label:"任务名称","min-width":"200"},{default:b(({row:_})=>[m("div",Po,[m("a",{href:Ie(_),target:"_blank",class:"source-link",title:`完整转存链接: ${Ie(_)}`},[G(X(_.name||"未命名任务")+" ",1),c(B,{class:"link-icon"},{default:b(()=>[c(Q(sn))]),_:1})],8,Io)])]),_:1}),c(De,{label:"分享链接","min-width":"300"},{default:b(({row:_})=>[m("div",Oo,[_.share_info?(R(),te("a",{key:0,href:We(_.share_info),target:"_blank",class:"share-link",title:`分享链接: ${We(_.share_info)}`},[G(X(We(_.share_info))+" ",1),c(B,{class:"copy-icon",onClick:zt(Oe=>K(_.share_info),["prevent"])},{default:b(()=>[c(Q(un))]),_:1},8,["onClick"])],8,$o)):(R(),te("span",Ao,"未生成分享链接"))])]),_:1}),c(De,{prop:"save_dir",label:"保存路径","min-width":"200"},{default:b(({row:_})=>[m("div",{class:"save-dir text-truncate",title:_.save_dir},X(_.save_dir),9,No)]),_:1}),c(De,{prop:"status",label:"状态",width:"100"},{default:b(({row:_})=>[c(Ve,{type:tn(_.status),size:"small"},{default:b(()=>[G(X(nn(_.status)),1)]),_:2},1032,["type"])]),_:1}),c(De,{prop:"message",label:"消息","min-width":"200"},{default:b(({row:_})=>[m("div",{class:"task-message text-truncate",title:_.message},X(_.message||"-"),9,Mo)]),_:1}),c(De,{label:"高级功能","min-width":"150"},{default:b(({row:_})=>[m("div",Vo,[_.cron?(R(),we(Ve,{key:0,size:"small",type:"warning",style:{"margin-right":"4px"}},{default:b(()=>[...d[8]||(d[8]=[G(" 定时 ",-1)])]),_:1})):le("",!0),_.regex_pattern?(R(),we(Ve,{key:1,size:"small",type:"info",style:{"margin-right":"4px"}},{default:b(()=>[...d[9]||(d[9]=[G(" 过滤 ",-1)])]),_:1})):le("",!0),_.regex_replace?(R(),we(Ve,{key:2,size:"small",type:"success",style:{"margin-right":"4px"}},{default:b(()=>[...d[10]||(d[10]=[G(" 重命名 ",-1)])]),_:1})):le("",!0),!_.cron&&!_.regex_pattern&&!_.regex_replace?(R(),te("span",Ro," - ")):le("",!0)])]),_:1}),c(De,{label:"操作",width:"200",fixed:"right"},{default:b(({row:_})=>[c(on,{size:"small"},{default:b(()=>[c(ve,{type:"primary",onClick:Oe=>ie(_.order-1),disabled:_.status==="running"},{default:b(()=>[c(B,null,{default:b(()=>[c(Q(Pt))]),_:1})]),_:1},8,["onClick","disabled"]),c(ve,{onClick:Oe=>$(_)},{default:b(()=>[c(B,null,{default:b(()=>[c(Q(cn))]),_:1})]),_:1},8,["onClick"]),c(ve,{onClick:Oe=>h(_.order-1)},{default:b(()=>[c(B,null,{default:b(()=>[c(Q(dn))]),_:1})]),_:1},8,["onClick"]),c(ve,{type:"danger",onClick:Oe=>M(_.order-1)},{default:b(()=>[c(B,null,{default:b(()=>[c(Q(It))]),_:1})]),_:1},8,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"])),[[rn,Q(a)]]),ln((R(),te("div",Bo,[q.value.length===0?(R(),te("div",Fo,[...d[11]||(d[11]=[m("div",{class:"empty-text"},"暂无任务",-1)])])):le("",!0),(R(!0),te(wt,null,Tt(q.value,_=>(R(),te("div",{key:_.order,class:"task-card"},[m("div",Lo,[m("div",zo,[m("div",Wo,[m("h4",Xo,[m("a",{href:Ie(_),target:"_blank",class:"source-link"},[G(X(_.name||"未命名任务")+" ",1),c(B,{class:"link-icon"},{default:b(()=>[c(Q(sn))]),_:1})],8,Yo)]),m("div",Uo,"#"+X(_.order),1)]),c(Ve,{type:tn(_.status),size:"default"},{default:b(()=>[G(X(nn(_.status)),1)]),_:2},1032,["type"])]),m("div",Ho,[m("div",Go,[d[12]||(d[12]=m("span",{class:"label"},"保存路径:",-1)),m("span",jo,X(_.save_dir),1)]),_.category?(R(),te("div",qo,[d[13]||(d[13]=m("span",{class:"label"},"分类:",-1)),m("span",Ko,X(_.category),1)])):le("",!0),_.message?(R(),te("div",Qo,[d[14]||(d[14]=m("span",{class:"label"},"消息:",-1)),m("span",Zo,X(_.message),1)])):le("",!0),_.cron||_.regex_pattern||_.regex_replace?(R(),te("div",Jo,[d[18]||(d[18]=m("span",{class:"label"},"高级功能:",-1)),m("div",er,[_.cron?(R(),we(Ve,{key:0,size:"small",type:"warning"},{default:b(()=>[...d[15]||(d[15]=[G("定时",-1)])]),_:1})):le("",!0),_.regex_pattern?(R(),we(Ve,{key:1,size:"small",type:"info"},{default:b(()=>[...d[16]||(d[16]=[G("过滤",-1)])]),_:1})):le("",!0),_.regex_replace?(R(),we(Ve,{key:2,size:"small",type:"success"},{default:b(()=>[...d[17]||(d[17]=[G("重命名",-1)])]),_:1})):le("",!0)])])):le("",!0),_.share_info?(R(),te("div",tr,[d[20]||(d[20]=m("span",{class:"label"},"分享链接:",-1)),m("a",{href:We(_.share_info),target:"_blank",class:"share-link"},[d[19]||(d[19]=G(" 查看分享链接 ",-1)),c(B,{class:"copy-icon",onClick:zt(Oe=>K(_.share_info),["prevent"])},{default:b(()=>[c(Q(un))]),_:1},8,["onClick"])],8,nr)])):le("",!0)])]),m("div",ar,[m("button",{class:"action-btn action-btn-primary",onClick:Oe=>ie(_.order-1),disabled:_.status==="running",title:_.status==="running"?"执行中...":"执行任务"},[c(B,null,{default:b(()=>[c(Q(Pt))]),_:1})],8,or),m("button",{class:"action-btn",onClick:Oe=>$(_),title:"编辑任务"},[c(B,null,{default:b(()=>[c(Q(cn))]),_:1})],8,rr),m("button",{class:"action-btn",onClick:Oe=>h(_.order-1),title:"分享任务"},[c(B,null,{default:b(()=>[c(Q(dn))]),_:1})],8,lr),m("button",{class:"action-btn action-btn-danger",onClick:Oe=>M(_.order-1),title:"删除任务"},[c(B,null,{default:b(()=>[c(Q(It))]),_:1})],8,ir)])]))),128))])),[[rn,Q(a)]])]),c(_a,{modelValue:j.value,"onUpdate:modelValue":[d[3]||(d[3]=_=>j.value=_),ae],task:w.value,onSuccess:L},null,8,["modelValue","task"]),c(qa,{modelValue:P.value,"onUpdate:modelValue":[d[4]||(d[4]=_=>P.value=_),Ge],task:I.value,"task-id":F.value,onTaskCompleted:J,onTaskCancelled:Ce},null,8,["modelValue","task","task-id"])])}}}),gr=Gt(sr,[["__scopeId","data-v-32f43dc3"]]);export{gr as default};
